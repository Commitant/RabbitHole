# RabbitHole
<p>AES-256 encrypted file archive with any number of hidden volumes for plausible deniability.<img        src="https://github.com/eflite/RabbitHole/blob/master/rabbitHoleLogo3.png" align="right">
</p>

* Encrypted file archive
* AES 256 (Rijndael block cipher)
* Bouncy Castle, trusted crypto
* Any number of hidden volumes
* Encrypted volumes indistinguishable from random data
* Plausible deniability 
* Very small code base, easily inspected and audited
* Open source, free software (GNU GPL v3)

## Introduction
Inspired by TrueCrypt and similar software, this application offers serious encryption for your files through a command line tool for Windows. It's uses [BouncyCastle 1.8.1](https://en.wikipedia.org/wiki/Bouncy_Castle_(cryptography)), an acclaimed crypto library providing strong encryption. Because your file archive is first populated with random data, any encrypted volumes you create inside are indistinguishable from the random data. Thus there is no way to ascertain whether you have 0, 1, 2 or 20 volumes within your archive. This gives you [plausible deniability](https://en.wikipedia.org/wiki/Plausible_deniability#Use_in_cryptography), so that an adversary cannot prove or be sure that any encrypted volume exists. A typical way to use this is to create at least 2 volumes, one that you can safely decrypt and reveal should you be forced to, and one that contains your real secrets and which existence you can plausibly deny. For a cryptography tool to have any value we believe is has to be open source software, so users and experts can inspect the code and make sure no vulnerabilities or back doors exists. That is why this project is released under the open source GPLv3 lisence. For maximum security, download the source code, download the [Bouncy Castle crypto library for C#](https://www.nuget.org/packages/BouncyCastle.Crypto.dll/) and compile it yourself.   

## How it works
When you create a new file archive with RabbitHole you specify the file name and total archive size, and a new file is created and filled with random data. The Sha512 Bouncy Castle random generator, a cryptographically secure pseudo random function [(a CSPRF)](https://en.wikipedia.org/wiki/Cryptographically_secure_pseudorandom_number_generator) is used and seeded with entropy collected from the keyboard though keystroke timings. When you later create logical volumes within the archive, there is no way to distinguish these from garbage random data from the random generator. There is no header information within the archive specifying the number or the sizes of the logical volumes. The only thing that identifies a volume is the password you chose for it, and this is obviously not written to the file. Rather, when opening an archive and entering the password for the volume you want to open, the application tries to read data at different positions and decrypt it with your password. It will first try to read at the start of the archive with an offset calculated from the hash of the password, then it will try at half way through the file plus the offset, then at half way of the remaing part of the file plus the offset etc, etc. It will repeat this process until a volume decrypts successfully or the file is exhausted. 
As the start positions is halved for every volume you create, the allocated space for each volume is also halved. This means that if you create an archive of size N bytes, your first volume can occupy n/2 bytes, your second volume can occupy n/4 bytes, your third can occupy n/8 bytes etc. Because each volume requires at least 1068 bytes, a 1 MB archive allows for 10 volumes, a 10 MB archive allows for 14 volumes, and a 100 MB archive allows for 17 volumes etc.

A volume can can contain any number of files with unique names. To keep the code base small, a volume cannot contain sub folders, but this can be remedied by first organazing your file structure in a ZIP file (or any other archive) before adding it to your RabbitHole archive. If you try to add more files to a volume than there is allocated space for by default, you will be prompted for confirmation. As the software itself does not know whether you have created more volumes than the one you are currently accessing, it will allow exhausting this threshold if you confirm your action. 

Example: You have created an archive of a total of 100 MB, and created 3 volumes within. By default, the first archive will have allocated 50 MB, the second will have 25 MB, and the third will have 12.5 MB. However, because you have no more volumes after the third one, you can safely use the remaining space for the third volume, allowing it 25 MB in total. But if you try to add more than 12.5 MB in the third volume, it will prompt you for confirmation, because it doesn't know whether you have a fourth volume or not (or any other number of successive volumes). So in effect, only the last volume can exceed its default allocated space. The software will allow you to exceed the default allocation if confirmed, but if you do this on any volume other than the last, all successive volumes will be corrupted and forever lost. 
